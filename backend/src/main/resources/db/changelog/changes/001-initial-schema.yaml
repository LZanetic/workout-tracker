databaseChangeLog:
  - changeSet:
      id: 001-create-users-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: start_date
                  type: DATE
              - column:
                  name: estimated_squat_1rm
                  type: INTEGER
              - column:
                  name: estimated_bench_1rm
                  type: INTEGER
              - column:
                  name: estimated_deadlift_1rm
                  type: INTEGER
              - column:
                  name: role
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false
        - createIndex:
            tableName: users
            indexName: idx_users_email
            columns:
              - column:
                  name: email

  - changeSet:
      id: 002-create-training-blocks-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: training_blocks
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: created_by_user_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: users(id)
                    foreignKeyName: fk_training_blocks_created_by
              - column:
                  name: assigned_to_user_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: users(id)
                    foreignKeyName: fk_training_blocks_assigned_to
              - column:
                  name: block_length
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: progression_rate
                  type: NUMERIC(5,4)
                  constraints:
                    nullable: false
              - column:
                  name: deload_rate
                  type: NUMERIC(5,4)
                  constraints:
                    nullable: false
              - column:
                  name: macrocycle
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: mesocycle
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false
        - createIndex:
            tableName: training_blocks
            indexName: idx_training_blocks_created_by_user_id
            columns:
              - column:
                  name: created_by_user_id
        - createIndex:
            tableName: training_blocks
            indexName: idx_training_blocks_assigned_to_user_id
            columns:
              - column:
                  name: assigned_to_user_id

  - changeSet:
      id: 003-create-weeks-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: weeks
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: block_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: training_blocks(id)
                    foreignKeyName: fk_weeks_block
              - column:
                  name: week_number
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: week_type
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: start_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: DATE
                  constraints:
                    nullable: false
        - createIndex:
            tableName: weeks
            indexName: idx_weeks_block_id
            columns:
              - column:
                  name: block_id

  - changeSet:
      id: 004-create-workout-days-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: workout_days
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: week_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: weeks(id)
                    foreignKeyName: fk_workout_days_week
              - column:
                  name: day_number
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: day_name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: rest_day
                  type: BOOLEAN
                  constraints:
                    nullable: false
        - createIndex:
            tableName: workout_days
            indexName: idx_workout_days_week_id
            columns:
              - column:
                  name: week_id

  - changeSet:
      id: 005-create-exercises-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: exercises
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: day_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: workout_days(id)
                    foreignKeyName: fk_exercises_day
              - column:
                  name: name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: category
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: order_in_workout
                  type: INTEGER
                  constraints:
                    nullable: false
        - createIndex:
            tableName: exercises
            indexName: idx_exercises_day_id
            columns:
              - column:
                  name: day_id

  - changeSet:
      id: 006-create-prescribed-sets-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: prescribed_sets
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: exercise_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: exercises(id)
                    foreignKeyName: fk_prescribed_sets_exercise
              - column:
                  name: set_number
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: target_sets
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: target_reps
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: target_load_min
                  type: NUMERIC(6,2)
              - column:
                  name: target_load_max
                  type: NUMERIC(6,2)
              - column:
                  name: target_rpe
                  type: INTEGER
              - column:
                  name: tempo
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: video_required
                  type: BOOLEAN
                  constraints:
                    nullable: false
        - createIndex:
            tableName: prescribed_sets
            indexName: idx_prescribed_sets_exercise_id
            columns:
              - column:
                  name: exercise_id

  - changeSet:
      id: 007-create-actual-sets-table
      author: workout-tracker
      changes:
        - createTable:
            tableName: actual_sets
            columns:
              - column:
                  name: id
                  type: BIGSERIAL
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: exercise_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    references: exercises(id)
                    foreignKeyName: fk_actual_sets_exercise
              - column:
                  name: prescribed_set_id
                  type: BIGINT
                  references: prescribed_sets(id)
                  foreignKeyName: fk_actual_sets_prescribed_set
              - column:
                  name: set_number
                  type: INTEGER
                  constraints:
                    nullable: false
              - column:
                  name: actual_weight
                  type: NUMERIC(6,2)
              - column:
                  name: actual_reps
                  type: INTEGER
              - column:
                  name: actual_rpe
                  type: INTEGER
              - column:
                  name: tempo_used
                  type: VARCHAR(50)
              - column:
                  name: video_recorded
                  type: BOOLEAN
                  constraints:
                    nullable: false
              - column:
                  name: feedback
                  type: TEXT
              - column:
                  name: completed_at
                  type: TIMESTAMP
        - createIndex:
            tableName: actual_sets
            indexName: idx_actual_sets_exercise_id
            columns:
              - column:
                  name: exercise_id
        - createIndex:
            tableName: actual_sets
            indexName: idx_actual_sets_prescribed_set_id
            columns:
              - column:
                  name: prescribed_set_id
        - createIndex:
            tableName: actual_sets
            indexName: idx_actual_sets_completed_at
            columns:
              - column:
                  name: completed_at




